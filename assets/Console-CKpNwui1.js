import{m as R,r as u,f as S,a as r,j as n,w as i,o as l,F as _,k as y,e,u as k,J as N,q as G,h as m,n as O,t as T,z as b,P as V,Q as B,v as j}from"./index-BcfOFOtS.js";import{i as U}from"./index-C4p-fL-U.js";import{B as L}from"./BoxView-Bvy9F3Hd.js";import{I as q}from"./index-D11BFAeF.js";const F=()=>U.get("/api/db/tables"),H=w=>U.get(`/api/db/table/${w}`),P={class:"flex flex-col lg:flex-row box-wrapper"},J=["onClick"],Q={class:"flex-grow truncate"},X={class:"flex flex-row items-center hover:bg-gray-100 p-2 rounded-md cursor-pointer active:bg-gray-200"},K={class:"overflow-x-auto"},W={class:"min-w-full border border-gray-300 text-sm"},Y={class:"border border-gray-300 px-1 py-1"},Z=["onUpdate:modelValue","onChange"],ee={class:"border border-gray-300 px-1 py-1"},te=["onUpdate:modelValue","onChange"],oe=["value"],se={class:"border border-gray-300 px-1 py-1"},ae=["onUpdate:modelValue","onChange"],le={class:"border border-gray-300 px-1 py-1"},re=["onUpdate:modelValue","onChange"],ne={class:"border px-1 py-1 text-center"},de={class:"hidden lg:block"},ce=["onClick"],ue=["onClick"],ie=["onClick"],pe={class:"lg:hidden"},xe={__name:"Console",setup(w){const C=u([]),g=u(null),d=u(null),v=u(!0),f=u(!1),h=["INTEGER","REAL","TEXT","BLOB","NULL","VARCHAR","CHAR","BOOLEAN","DATE","DATETIME"],E=async()=>{v.value=!0;const a=await F();C.value=a.data.data,v.value=!1},$=async a=>{if(a){g.value=a,f.value=!0;const s=await H(a);d.value=s.data.data.map(x=>({...x,_key:Date.now()+Math.random()})),f.value=!1}},A=a=>{const s={name:"",type:h[0],notnull:0,dflt_value:"",_key:Date.now()+Math.random()};d.value.splice(a,0,s)},D=a=>{const s={name:"",type:h[0],notnull:0,dflt_value:"",_key:Date.now()+Math.random()};d.value.splice(a+1,0,s)},M=a=>{d.value.splice(a,1)},p=a=>{a._key=Date.now()+Math.random()};return S(()=>{E()}),(a,s)=>{const x=m("a-spin"),z=m("a-button"),I=m("a-empty");return l(),r("div",P,[n(L,{class:"w-full lg:w-1/5 lg:mr-4"},{default:i(()=>[n(x,{loading:v.value,class:"w-full h-full"},{default:i(()=>[(l(!0),r(_,null,y(C.value,(o,c)=>(l(),r("div",{onClick:t=>$(o.name),class:O(["flex flex-row items-center hover:bg-gray-100 p-2 rounded-md cursor-pointer active:bg-gray-200",g.value==o.name&&"bg-gray-200"]),key:c},[n(k(q),{size:"24",class:"mr-2 flex-shrink-0"}),e("span",Q,T(o.name),1)],10,J))),128)),e("div",X,[n(k(N),{size:"24",class:"mr-2 flex-shrink-0"}),s[0]||(s[0]=e("span",{class:"flex-grow truncate"},"新建表",-1))])]),_:1},8,["loading"])]),_:1}),n(L,{class:"boxRight"},{default:i(()=>[n(x,{loading:f.value,class:"w-full h-full"},{default:i(()=>[g.value&&d.value?(l(),r(_,{key:0},[s[4]||(s[4]=e("div",{class:"flex flex-row items-center space-x-4 mb-4 border-b pb-2"},[e("span",{class:"text-lg font-semibold cursor-pointer hover:text-blue-600 transition-colors duration-200"},"表结构"),e("span",{class:"text-lg font-semibold cursor-pointer hover:text-blue-600 transition-colors duration-200"},"表数据")],-1)),e("div",K,[e("table",W,[s[3]||(s[3]=e("thead",null,[e("tr",{class:"bg-gray-100"},[e("th",{class:"border border-gray-300 text-xs"},"字段名"),e("th",{class:"border border-gray-300 text-xs"},"类型"),e("th",{class:"border border-gray-300 text-xs"},"是否可空"),e("th",{class:"border border-gray-300 text-xs"},"默认值"),e("th",{class:"border border-gray-300 text-xs"},"操作")])],-1)),e("tbody",null,[(l(!0),r(_,null,y(d.value,(o,c)=>(l(),r("tr",{key:o._key,class:"hover:bg-gray-50"},[e("td",Y,[b(e("input",{"onUpdate:modelValue":t=>o.name=t,class:"border border-gray-300 w-full px-1 py-0.5 text-xs",onChange:t=>p(o)},null,40,Z),[[V,o.name,void 0,{lazy:!0}]])]),e("td",ee,[b(e("select",{"onUpdate:modelValue":t=>o.type=t,class:"border border-gray-300 w-full px-1 py-0.5 text-xs",onChange:t=>p(o)},[(l(),r(_,null,y(h,t=>e("option",{key:t,value:t},T(t),9,oe)),64))],40,te),[[B,o.type]])]),e("td",se,[b(e("select",{"onUpdate:modelValue":t=>o.notnull=t,class:"border border-gray-300 w-full px-1 py-0.5 text-xs",onChange:t=>p(o)},s[1]||(s[1]=[e("option",{value:1},"是",-1),e("option",{value:0},"否",-1)]),40,ae),[[B,o.notnull]])]),e("td",le,[b(e("input",{"onUpdate:modelValue":t=>o.dflt_value=t,placeholder:"NULL",class:"border border-gray-300 w-full px-1 py-0.5 text-xs",onChange:t=>p(o)},null,40,re),[[V,o.dflt_value,void 0,{lazy:!0}]])]),e("td",ne,[e("div",de,[e("button",{onClick:t=>A(c),class:"text-blue-600 hover:text-blue-800 mr-1 text-xs"},"前增",8,ce),e("button",{onClick:t=>D(c),class:"text-blue-600 hover:text-blue-800 mr-1 text-xs"},"后增",8,ue),e("button",{onClick:t=>M(c),class:"text-red-600 hover:text-red-800 text-xs"},"删除",8,ie)]),e("div",pe,[n(z,{size:"mini",type:"text"},{default:i(()=>s[2]||(s[2]=[j("操作")])),_:1})])])]))),128))])])])],64)):(l(),G(I,{key:1,class:"w-full h-full flex items-center justify-center"}))]),_:1},8,["loading"])]),_:1})])}}},fe=R(xe,[["__scopeId","data-v-cc16f265"]]);export{fe as default};
