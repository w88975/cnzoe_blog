import{r as i,c as V,D as B,f as P,o as d,a as b,z as D,E as F,e,G as _,F as U,s as S,n as N,t as M,v as A,h as z,m as L,w as j,b as R,x as I,j as $,u as O,H,k as E,q,J,N as K,K as W}from"./index-BekGhLC_.js";import{g as G}from"./db-DQ5vIj5x.js";import{O as Q,s as X}from"./config-CY73bole.js";const Y={class:"relative w-full max-w-2xl mx-auto"},Z={key:0,class:"absolute right-2 bottom-2"},ee={key:1,class:"tag-selector mt-2 p-2 border rounded-lg shadow-sm bg-white"},te=["onClick"],se={__name:"TagInput",setup(y,{expose:k}){const v=i(null),f=i(!1),m=i([]),c=i(""),o=i(!1),n=i(0),w=i(""),p=async s=>{o.value=!0;try{const a=await G({tableName:"tags"}),r=a.data.data.list.map(x=>x.value);return console.log(a.data.data.list),r.filter(x=>x.toLowerCase().startsWith(s.toLowerCase()))}finally{o.value=!1}},l=V(()=>m.value.filter(s=>s.toLowerCase().startsWith(w.value.toLowerCase()))),C=async()=>{const s=v.value.selectionStart,r=c.value.slice(0,s).match(/#(\w*)$/);r?(w.value=r[1],f.value=!0,m.value=await p(w.value),n.value=0):f.value=!1},u=s=>{if(f.value)switch(s.key){case"ArrowDown":s.preventDefault(),n.value=(n.value+1)%l.value.length;break;case"ArrowUp":s.preventDefault(),n.value=(n.value-1+l.value.length)%l.value.length;break;case"Enter":s.preventDefault(),l.value.length>0&&t(l.value[n.value]);break;case"Escape":f.value=!1;break}},t=s=>{const a=v.value.selectionStart,r=c.value.slice(0,a).replace(/#\w*$/,""),x=c.value.slice(a);c.value=`${r}#${s} ${x}`,f.value=!1,A(()=>{const g=r.length+s.length+2;v.value.setSelectionRange(g,g),v.value.focus()}),n.value=0,w.value=""};return k({insertText:s=>{v.value.selectionStart}}),B(l,s=>{s.length>0&&(n.value=0)}),P(()=>{v.value.focus()}),(s,a)=>(d(),b("div",Y,[D(e("textarea",{ref_key:"inputRef",ref:v,placeholder:"分享你的想法...",class:"rich-input w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-300 resize-none text-sm sm:text-base",onInput:C,onKeydown:u,"onUpdate:modelValue":a[0]||(a[0]=r=>c.value=r),rows:"4"},null,544),[[F,c.value]]),o.value?(d(),b("div",Z,a[1]||(a[1]=[e("svg",{class:"animate-spin h-5 w-5 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):_("",!0),f.value&&l.value.length>0?(d(),b("div",ee,[(d(!0),b(U,null,S(l.value,(r,x)=>(d(),b("div",{key:r,class:N(["cursor-pointer p-2 rounded transition-colors duration-200 text-sm sm:text-base",x===n.value?"bg-blue-100":"hover:bg-gray-100"]),onClick:g=>t(r)},M(r),11,te))),128))])):_("",!0)]))}},le={class:"relative"},ae={key:0,class:"absolute bottom-full left-0 mb-2 bg-white rounded-lg shadow-lg p-4 w-64"},oe={class:"grid grid-cols-6 gap-2"},ne=["onClick"],re={__name:"EmojiPicker",emits:["select"],setup(y,{emit:k}){const v=i(!1),f=["😀","😂","😍","🥳","😎","🤔","😊","👍","🎉","🌟","💖","🔥","👀","🙌","💯","🤩"],m=()=>{v.value=!v.value},c=n=>{o("select",n),v.value=!1},o=k;return(n,w)=>(d(),b("div",le,[e("button",{onClick:m,class:"text-blue-500 hover:bg-blue-100 p-2 rounded-full"},w[0]||(w[0]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)])),v.value?(d(),b("div",ae,[e("div",oe,[(d(),b(U,null,S(f,p=>e("button",{key:p,onClick:l=>c(p),class:"text-2xl hover:bg-gray-100 p-2 rounded"},M(p),9,ne)),64))])])):_("",!0)]))}},ie={class:"w-full max-w-md mx-auto"},ue={class:"mb-4"},de={for:"file-upload",class:"flex justify-center items-center w-full h-32 px-4 transition bg-white border-2 border-gray-300 border-dashed rounded-md appearance-none cursor-pointer hover:border-gray-400 focus:outline-none"},ce={class:"flex items-center space-x-2"},ve={class:"font-medium text-gray-600"},pe=["accept"],ge={key:0,class:"mb-4"},be={class:"w-full bg-gray-200 rounded-full h-2.5"},me={key:1,class:"space-y-2"},fe={class:"text-sm truncate"},we=["onClick"],T={__name:"UploadContent",props:{type:{type:String,default:"image",validator:y=>["image","video"].includes(y)}},emits:["complete"],setup(y,{expose:k,emit:v}){const f=y,m=v,c=i(!1),o=i([]),n=i(0),w=V(()=>f.type==="video"?"video/*":"image/*"),p=s=>{const a=Array.from(s.target.files);o.value=[...o.value,...a.map(r=>({file:r,preview:URL.createObjectURL(r),progress:0}))]},l=s=>{URL.revokeObjectURL(o.value[s].preview),o.value.splice(s,1),t()},C=async()=>{c.value=!0;const s=o.value.map((a,r)=>a.progress===0?u(r):Promise.resolve());await Promise.all(s),console.log("upload complete"),c.value=!1,m("complete",o.value.map(a=>Q+a.url),f.type)},u=s=>new Promise((a,r)=>{const x=o.value[s].file;I(x,g=>{o.value[s].progress=parseFloat(g.progress),t()},"/SNS").then(g=>(o.value[s].progress=100,o.value[s].url=g.url,t(),console.log(`File uploaded: ${g.url}`),X({url:g.url,dir:"/SNS",fileSize:g.fileSize,type:x.type,name:x.name}))).then(g=>{console.log(`Upload data saved: ${g.id}`),a(g)}).catch(g=>{console.error(`Upload failed for file ${x.name}:`,g),r(g)})}),t=()=>{const s=o.value.reduce((a,r)=>a+r.progress,0);n.value=o.value.length>0?s/o.value.length:0};return k({doUpload:()=>{C()}}),(s,a)=>{const r=z("a-spin");return d(),L(r,{class:"w-full",loading:c.value},{default:j(()=>[e("div",ie,[e("div",ue,[e("label",de,[e("span",ce,[a[0]||(a[0]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-6 h-6 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1)),e("span",ve,M(y.type==="video"?"上传视频":"上传图片"),1)]),e("input",{id:"file-upload",type:"file",accept:w.value,class:"hidden",multiple:"",onChange:p},null,40,pe)])]),o.value.length>0?(d(),b("div",ge,[a[1]||(a[1]=e("div",{class:"text-sm font-medium text-gray-700 mb-2"},"上传进度",-1)),e("div",be,[e("div",{class:"bg-blue-600 h-2.5 rounded-full",style:R({width:`${n.value}%`})},null,4)])])):_("",!0),o.value.length>0?(d(),b("div",me,[(d(!0),b(U,null,S(o.value,(x,g)=>(d(),b("div",{key:g,class:"flex items-center justify-between p-2 bg-gray-100 rounded-md"},[e("span",fe,M(x.file.name),1),e("button",{onClick:Pe=>l(g),class:"text-red-500 hover:text-red-700"},a[2]||(a[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]),8,we)]))),128))])):_("",!0)])]),_:1},8,["loading"])}}},he={key:0,class:"mt-4"},xe={class:"relative bg-gray-100 aspect-square border border-gray-200 rounded-md overflow-hidden group cursor-move"},ye=["src"],ke=["src"],_e={class:"absolute top-1 left-1 bg-black bg-opacity-50 rounded-full p-1"},Ce={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 text-white",viewBox:"0 0 20 20",fill:"currentColor"},$e={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 text-white",viewBox:"0 0 20 20",fill:"currentColor"},Me={class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity"},je={__name:"UploadedPreview",props:{files:{type:Array,required:!1,default:()=>[]}},emits:["update:files"],setup(y,{emit:k}){i(!1);const v=y,f=k,m=i(!1),c=i(null),o=V({get:()=>v.files,set:p=>f("update:files",p)}),n=()=>{const p=[...o.value];p.splice(c.value,1),f("update:files",p),m.value=!1},w=p=>{c.value=p,m.value=!0};return(p,l)=>{const C=z("NvaModal");return d(),b(U,null,[y.files.length>0?(d(),b("div",he,[l[6]||(l[6]=e("h3",{class:"text-sm font-semibold text-gray-700 mb-2"},"Uploaded Content:",-1)),$(O(H),{modelValue:o.value,"onUpdate:modelValue":l[1]||(l[1]=u=>o.value=u),class:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-2","item-key":"url"},{item:j(({element:u})=>[e("div",xe,[u.type==="image"?(d(),b("img",{key:0,src:u.url,alt:"Uploaded image",class:"w-full h-full object-contain"},null,8,ye)):u.type==="video"?(d(),b("video",{key:1,src:u.url,class:"w-full h-full object-contain"},null,8,ke)):_("",!0),e("div",_e,[u.type==="image"?(d(),b("svg",Ce,l[3]||(l[3]=[e("path",{"fill-rule":"evenodd",d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z","clip-rule":"evenodd"},null,-1)]))):u.type==="video"?(d(),b("svg",$e,l[4]||(l[4]=[e("path",{d:"M2 6a2 2 0 012-2h6a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V6zM14.553 7.106A1 1 0 0014 8v4a1 1 0 00.553.894l2 1A1 1 0 0018 13V7a1 1 0 00-1.447-.894l-2 1z"},null,-1)]))):_("",!0)]),e("div",Me,[e("button",{onClick:l[0]||(l[0]=t=>w(p.index)),class:"text-white hover:text-red-500 focus:outline-none"},l[5]||(l[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]))])])]),_:1},8,["modelValue"])])):_("",!0),$(C,{modelValue:m.value,"onUpdate:modelValue":l[2]||(l[2]=u=>m.value=u),title:"Delete Post",onOk:n},{default:j(()=>l[7]||(l[7]=[e("p",null,"Are you sure you want to delete this post?",-1)])),_:1},8,["modelValue"])],64)}}},Ue={class:"max-w-2xl mx-auto"},Ve={class:"bg-white rounded-lg shadow mb-6"},Le={class:"p-4"},Se={class:"relative"},Te={class:"flex items-center justify-between mt-3"},ze={class:"flex space-x-2"},Be={__name:"index",setup(y){i(!1),i(!1),i([]);const k=i(null),v=i(null),f=i(""),m=i(!1),c=i(""),o=i(!0),n=i([]),w=V(()=>c.value==="image"?"Upload Image":"Upload Video"),p=u=>{c.value=u,m.value=!0},l=(u,t)=>{console.log("upload complete",u);const h=u.map(a=>({url:a,type:t})),s=Array.from(new Set([...n.value,...h].map(JSON.stringify))).map(JSON.parse);n.value=s,console.log("uploadedFiles",n.value),m.value=!1},C=u=>{console.log(u),v.value.insertText(u)};return(u,t)=>(d(),b(U,null,[e("div",Ue,[e("div",Ve,[e("div",Le,[e("div",Se,[$(se,{modelValue:f.value,"onUpdate:modelValue":t[0]||(t[0]=h=>f.value=h),ref_key:"tagInputRef",ref:v},null,8,["modelValue"])]),e("div",Te,[e("div",ze,[e("button",{onClick:t[1]||(t[1]=h=>p("image")),class:"text-blue-500 hover:bg-blue-100 p-2 rounded-full"},t[7]||(t[7]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)])),e("button",{onClick:t[2]||(t[2]=h=>p("video")),class:"text-blue-500 hover:bg-blue-100 p-2 rounded-full"},t[8]||(t[8]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)])),t[9]||(t[9]=e("button",{class:"text-blue-500 hover:bg-blue-100 p-2 rounded-full"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})])],-1)),$(re,{onSelect:C})]),t[10]||(t[10]=e("button",{class:"bg-blue-500 text-white px-4 py-2 rounded-full hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"}," Post ",-1))]),$(je,{files:n.value,"onUpdate:files":t[3]||(t[3]=h=>n.value=h)},null,8,["files"]),q(" "+M(n.value),1)])]),t[11]||(t[11]=J('<div class="space-y-6 mb-4" data-v-34ac9bb5><div class="bg-white rounded-lg shadow overflow-hidden" data-v-34ac9bb5><div class="p-4" data-v-34ac9bb5><p class="text-gray-800 mb-4" data-v-34ac9bb5>This is a sample post with some text content. It could be longer or shorter depending on the user&#39;s input.</p><div class="grid grid-cols-3 gap-2 mb-4" data-v-34ac9bb5><img src="https://via.placeholder.com/150" alt="Post image" class="w-full h-32 object-cover rounded" data-v-34ac9bb5><img src="https://via.placeholder.com/150" alt="Post image" class="w-full h-32 object-cover rounded" data-v-34ac9bb5><img src="https://via.placeholder.com/150" alt="Post image" class="w-full h-32 object-cover rounded" data-v-34ac9bb5><img src="https://via.placeholder.com/150" alt="Post image" class="w-full h-32 object-cover rounded" data-v-34ac9bb5><div class="relative w-full h-32" data-v-34ac9bb5><img src="https://via.placeholder.com/150" alt="Post image" class="w-full h-full object-cover rounded" data-v-34ac9bb5><div class="absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center rounded" data-v-34ac9bb5><span class="text-white text-xl font-bold" data-v-34ac9bb5>+4</span></div></div></div><div class="flex items-center justify-between text-sm text-gray-500" data-v-34ac9bb5><span data-v-34ac9bb5>2 hours ago</span><span data-v-34ac9bb5>#sample #post</span></div><div class="flex items-center justify-between mt-4 pt-4 border-t" data-v-34ac9bb5><button class="flex items-center space-x-2 text-gray-500 hover:text-blue-500" data-v-34ac9bb5><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-34ac9bb5><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" data-v-34ac9bb5></path></svg><span data-v-34ac9bb5>23 Comments</span></button><button class="flex items-center space-x-2 text-gray-500 hover:text-red-500" data-v-34ac9bb5><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-34ac9bb5><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" data-v-34ac9bb5></path></svg><span data-v-34ac9bb5>99 Likes</span></button></div></div></div></div><div class="space-y-6" data-v-34ac9bb5><div class="bg-white rounded-lg shadow overflow-hidden" data-v-34ac9bb5><div class="p-4" data-v-34ac9bb5><p class="text-gray-800 mb-4" data-v-34ac9bb5>This is a sample post with some text content. It could be longer or shorter depending on the user&#39;s input.</p><div class="flex items-center justify-between text-sm text-gray-500" data-v-34ac9bb5><span data-v-34ac9bb5>2 hours ago</span><span data-v-34ac9bb5>#sample #post</span></div><div class="flex items-center justify-between mt-4 pt-4 border-t" data-v-34ac9bb5><button class="flex items-center space-x-2 text-gray-500 hover:text-blue-500" data-v-34ac9bb5><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-34ac9bb5><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" data-v-34ac9bb5></path></svg><span data-v-34ac9bb5>23 Comments</span></button><button class="flex items-center space-x-2 text-gray-500 hover:text-red-500" data-v-34ac9bb5><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-34ac9bb5><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" data-v-34ac9bb5></path></svg><span data-v-34ac9bb5>99 Likes</span></button></div></div></div></div>',2))]),o.value?(d(),L(W,{key:1,visible:m.value,"onUpdate:visible":t[5]||(t[5]=h=>m.value=h),title:w.value,okText:"开始上传",onOk:t[6]||(t[6]=h=>k.value.doUpload())},{default:j(()=>[$(T,{type:c.value,ref_key:"uploadContentRef",ref:k,onComplete:l},null,8,["type"])]),_:1},8,["visible","title"])):(d(),L(K,{key:0,modelValue:m.value,"onUpdate:modelValue":t[4]||(t[4]=h=>m.value=h),title:w.value},{default:j(()=>[$(T,{type:c.value},null,8,["type"])]),_:1},8,["modelValue","title"]))],64))}},Ae=E(Be,[["__scopeId","data-v-34ac9bb5"]]);export{Ae as default};
