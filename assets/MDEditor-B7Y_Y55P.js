import{c as T}from"./blog-DjoqRpaT.js";import{i as h}from"./index-B9_7xlU2.js";import{r as a,f as B,a as V,h as l,w as u,e as x,M as i,j as o,o as g,q as y,F as C,s as E,p as D,m as U,y as j}from"./index-DJV0LrDg.js";const F=()=>h.get("/api/category/list/TAG");function q(c){return c?c.replace(/(\*\*|__)(.*?)(\*\*|__)/g,"").replace(/\!\[[\s\S]*?\]\([\s\S]*?\)/g,"").replace(/\([\s\S]*?\)/g,"").replace(/<\/?.+?\/?>/g,"").replace(/(\*)(.*?)(\*)/g,"").replace(/`{1,2}[^`](.*?)`{1,2}/g,"").replace(/```([\s\S]*?)```[\s]*/g,"").replace(/\~\~(.*?)\~\~/g,"").replace(/[\s]*[-\*\+]+(.*)/g,"").replace(/[\s]*[0-9]+\.(.*)/g,"").replace(/(#+)(.*)/g,"").replace(/(>+)(.*)/g,"").replace(/\r\n/g,"").replace(/\n/g,"").replace(/\s/g,"").slice(0,180):""}const z={class:"lg:hidden"},R={__name:"MDEditor",setup(c){const v=D(),d=a(null),n=a(""),p=a(""),m=a(!1),_=a([]),s=a([]);B(()=>{m.value=!0,F().then(r=>{_.value=r.data.data,m.value=!1})});const S=()=>{if(!d.value.text)return i.error("No Markdown content");if(!n.value)return i.error("No title");if(!s.value.length)return i.error("No tag");d.value.save()},b=async(r,e)=>{console.log(r,e),await T({title:n.value,value:e,tags:s.value.join(","),category_id:1,thumbnail:"",extra:q(r)}),i.success("Create success"),v.replace("/admin/post-list")};return(r,e)=>{const k=o("a-button"),w=o("TitleLine"),M=o("a-input"),L=o("a-option"),N=o("a-select"),f=o("v-md-editor");return g(),V("div",null,[l(w,{title:"Markdown Editor"},{right:u(()=>[l(k,{type:"primary",onClick:S},{default:u(()=>e[3]||(e[3]=[y("Save / Create")])),_:1})]),_:1}),l(M,{size:"mini",type:"text",modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=t=>n.value=t),placeholder:"Title",class:"w-full p-2 mb-4"},null,8,["modelValue"]),l(N,{class:"mb-4",loading:m.value,multiple:"",modelValue:s.value,"onUpdate:modelValue":e[1]||(e[1]=t=>s.value=t),placeholder:"Select a tag"},{default:u(()=>[(g(!0),V(C,null,E(_.value,t=>(g(),U(L,{key:t.id,value:t.id},{default:u(()=>[y(j(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["loading","modelValue"]),l(f,{ref_key:"mdEditor",ref:d,modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=t=>p.value=t),height:"800px",onSave:b},null,8,["modelValue"]),x("div",z,[e[4]||(e[4]=x("h1",{class:"text-2xl font-bold mb-4 mt-4"},"Preview",-1)),l(f,{"model-value":p.value,mode:"preview"},null,8,["model-value"])])])}}};export{R as default};
