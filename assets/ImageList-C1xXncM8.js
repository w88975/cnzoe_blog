import{e as D,d as z,g as B,f as y,i as V,o as f,b as g,n as M,h as U,a as p,_ as le,I as W,v as ce,x as ue,c as Z,y as de,l as m,m as pe,z as fe,j as d,w as v,F,A as me,B as _,r as k,k as I,p as A,u as ve,C as ke,D as ge,E as x,G as L,q as ye}from"./index-6XX0JJxk.js";import{B as _e}from"./BoxView-4vtJ-k38.js";import{I as Ce}from"./index-Dp_BiRyw.js";import{i as q}from"./index-CrRbIKnp.js";const $e=z({name:"IconCode",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:t}){const o=B("icon"),a=y(()=>[o,`${o}-code`,{[`${o}-spin`]:e.spin}]),l=y(()=>{const s={};return e.size&&(s.fontSize=V(e.size)?`${e.size}px`:e.size),e.rotate&&(s.transform=`rotate(${e.rotate}deg)`),s});return{cls:a,innerStyle:l,onClick:s=>{t("click",s)}}}}),be=["stroke-width","stroke-linecap","stroke-linejoin"],we=p("path",{d:"M16.734 12.686 5.42 24l11.314 11.314m14.521-22.628L42.57 24 31.255 35.314M27.2 6.28l-6.251 35.453"},null,-1),he=[we];function xe(e,t,o,a,l,i){return f(),g("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:M(e.cls),style:U(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:t[0]||(t[0]=(...s)=>e.onClick&&e.onClick(...s))},he,14,be)}var S=D($e,[["render",xe]]);const ze=Object.assign(S,{install:(e,t)=>{var o;const a=(o=t==null?void 0:t.iconPrefix)!=null?o:"";e.component(a+S.name,S)}}),Fe=z({name:"IconCommon",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:t}){const o=B("icon"),a=y(()=>[o,`${o}-common`,{[`${o}-spin`]:e.spin}]),l=y(()=>{const s={};return e.size&&(s.fontSize=V(e.size)?`${e.size}px`:e.size),e.rotate&&(s.transform=`rotate(${e.rotate}deg)`),s});return{cls:a,innerStyle:l,onClick:s=>{t("click",s)}}}}),Ie=["stroke-width","stroke-linecap","stroke-linejoin"],Le=p("path",{d:"M24 23 7.652 14.345M24 23l16.366-8.664M24 23v19.438M7 14v20l17 9 17-9V14L24 5 7 14Z"},null,-1),Se=[Le];function je(e,t,o,a,l,i){return f(),g("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:M(e.cls),style:U(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:t[0]||(t[0]=(...s)=>e.onClick&&e.onClick(...s))},Se,14,Ie)}var j=D(Fe,[["render",je]]);const Ne=Object.assign(j,{install:(e,t)=>{var o;const a=(o=t==null?void 0:t.iconPrefix)!=null?o:"";e.component(a+j.name,j)}}),De=z({name:"IconFolder",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:t}){const o=B("icon"),a=y(()=>[o,`${o}-folder`,{[`${o}-spin`]:e.spin}]),l=y(()=>{const s={};return e.size&&(s.fontSize=V(e.size)?`${e.size}px`:e.size),e.rotate&&(s.transform=`rotate(${e.rotate}deg)`),s});return{cls:a,innerStyle:l,onClick:s=>{t("click",s)}}}}),Be=["stroke-width","stroke-linecap","stroke-linejoin"],Ve=p("path",{d:"M6 13h18l-2.527-3.557a1.077 1.077 0 0 0-.88-.443H7.06C6.474 9 6 9.448 6 10v3Zm0 0h33.882c1.17 0 2.118.895 2.118 2v21c0 1.105-.948 3-2.118 3H8.118C6.948 39 6 38.105 6 37V13Z"},null,-1),Me=[Ve];function Ue(e,t,o,a,l,i){return f(),g("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:M(e.cls),style:U(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:t[0]||(t[0]=(...s)=>e.onClick&&e.onClick(...s))},Me,14,Be)}var N=D(De,[["render",Ue]]);const qe=Object.assign(N,{install:(e,t)=>{var o;const a=(o=t==null?void 0:t.iconPrefix)!=null?o:"";e.component(a+N.name,N)}}),Pe=z({name:"IconFile",props:{fileName:{type:String,required:!0},type:{type:Number,default:0}},setup(e){const t=a=>a.split(".").pop().toLowerCase();return{iconComponent:y(()=>{if(e.type===0)return qe;switch(t(e.fileName)){case"pdf":case"doc":case"docx":case"txt":return W;case"jpg":case"jpeg":case"png":case"gif":return Ce;case"mp4":case"avi":case"mov":return ue;case"mp3":case"wav":return ce;case"zip":case"rar":return Ne;case"js":case"vue":case"py":case"java":return ze;default:return W}})}}});function Re(e,t,o,a,l,i){return f(),Z(de(e.iconComponent))}const Ee=le(Pe,[["render",Re]]),Te=e=>q.get("/api/files/list",{params:{...e}}),We=e=>q.post("/api/files/create-folder",{...e}),O=e=>{const t=new FormData;return t.append("file",e.file),t.append("dir",e.dir),q.post("/api/files/upload",t,{headers:{"Content-Type":"multipart/form-data"}})},Ae="https://oss.cnzoe.com",Oe=["onClick"],Ze={class:"text-sm text-center truncate w-full block"},He={key:0,class:"absolute inset-0 bg-blue-500 bg-opacity-50 flex items-center justify-center"},Ge={class:"text-sm text-gray-500 mb-4"},et={__name:"ImageList",setup(e){const t=ye(),o=me(),a=m([]),l=m(!1),i=m("/"),s=m(!1),w=m(""),h=m(!1),P=m(null),C=m(!1),$=m(0),H=y(()=>{const n=i.value.split("/").filter(Boolean);return n.map((r,u)=>({name:r,path:"/"+n.slice(0,u+1).join("/")}))}),R=n=>{t.push({query:{dir:encodeURIComponent(n)}})};pe(()=>{const n=o.query.dir;n&&(i.value=decodeURIComponent(n)),b(i.value)}),fe(()=>o.query.dir,n=>{n&&(i.value=decodeURIComponent(n),b(i.value))});const G=async(n,r)=>{n===0?await t.push({query:{dir:encodeURIComponent(r)}}):window.open(`${Ae}${r}`,"_blank")},b=async n=>{l.value=!0;const r=await Te({dir:n});a.value=r.data.data,i.value=n,l.value=!1},J=()=>{s.value=!0},K=async()=>{if(!/^[a-zA-Z0-9_-]+$/.test(w.value)){_.warning("文件夹名称只能包含字母、数字、下划线和横杠");return}l.value=!0;const n=await We({dir:i.value,folder:w.value});n.data.success?(_.success("新建文件夹成功"),await b(i.value)):_.error(n.data.message),l.value=!1},Q=n=>{n.preventDefault(),$.value++,$.value===1&&(h.value=!0)},X=n=>{n.preventDefault(),$.value--,$.value===0&&(h.value=!1)},Y=async n=>{n.preventDefault(),h.value=!1,$.value=0;const r=Array.from(n.dataTransfer.files);C.value=!0;try{for(const u of r)await O({file:u,dir:i.value});_.success("Files uploaded successfully"),await b(i.value)}catch(u){_.error("Error uploading files"),console.error("Upload error:",u)}finally{C.value=!1}},ee=()=>{P.value.click()},te=async n=>{const r=Array.from(n.target.files);C.value=!0;try{for(const u of r)await O({file:u,dir:i.value});_.success("Files uploaded successfully"),await b(i.value)}catch(u){_.error("Error uploading files"),console.error("Upload error:",u)}finally{C.value=!1,n.target.value=""}};return(n,r)=>{const u=k("a-button"),ne=k("a-space"),oe=k("TitleLine"),E=k("a-breadcrumb-item"),se=k("a-breadcrumb"),re=k("a-spin"),ae=k("a-input"),ie=k("a-modal");return f(),g(F,null,[d(oe,{title:"File List"},{right:v(()=>[d(ne,null,{default:v(()=>[d(u,{type:"primary",onClick:J},{default:v(()=>r[4]||(r[4]=[I("新建文件夹")])),_:1})]),_:1})]),_:1}),d(re,{class:"w-full",loading:l.value||C.value},{default:v(()=>[d(_e,null,{default:v(()=>[d(se,{class:"mb-4"},{default:v(()=>[d(E,{onClick:r[0]||(r[0]=c=>R("/"))},{default:v(()=>r[5]||(r[5]=[I("Root")])),_:1}),(f(!0),g(F,null,A(H.value,(c,T)=>(f(),Z(E,{key:T,onClick:Je=>R(c.path)},{default:v(()=>[I(L(c.name),1)]),_:2},1032,["onClick"]))),128))]),_:1}),p("div",{class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4 auto-rows-auto relative",onDragenter:x(Q,["prevent"]),onDragover:r[1]||(r[1]=x(()=>{},["prevent"])),onDragleave:x(X,["prevent"]),onDrop:x(Y,["prevent"])},[(f(!0),g(F,null,A(a.value,c=>(f(),g("div",{onClick:T=>G(c.type,c.full_path),key:c.id,class:"flex flex-col items-center p-2 border rounded cursor-pointer active:opacity-50"},[d(Ee,{size:"24",type:c.type,fileName:c.path},null,8,["type","fileName"]),p("span",Ze,L(c.path),1)],8,Oe))),128)),p("div",{class:"flex flex-col items-center p-2 border rounded cursor-pointer active:opacity-50",onClick:ee},[d(ve(ke),{size:"24",class:"mb-2"}),r[6]||(r[6]=p("span",{class:"text-sm text-center break-words"},"上传",-1))]),h.value?(f(),g("div",He,r[7]||(r[7]=[p("p",{class:"text-white text-xl font-bold"},"Drop files here to upload",-1)]))):ge("",!0)],32)]),_:1})]),_:1},8,["loading"]),p("input",{type:"file",ref_key:"fileInput",ref:P,onChange:te,style:{display:"none"},multiple:""},null,544),d(ie,{visible:s.value,"onUpdate:visible":r[3]||(r[3]=c=>s.value=c),title:"新建文件夹",onOk:K},{default:v(()=>[p("div",Ge,"当前目录："+L(i.value),1),d(ae,{modelValue:w.value,"onUpdate:modelValue":r[2]||(r[2]=c=>w.value=c),placeholder:"请输入文件夹名称"},null,8,["modelValue"])]),_:1},8,["visible"])],64)}}};export{et as default};
