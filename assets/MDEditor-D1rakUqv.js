import{c as N}from"./blog-BBtnkx3l.js";import{C as T,r as a,f as h,a as V,j as l,w as u,e as x,M as i,h as o,o as g,q as S,F as B,s as E,p as D,m as U,t as j}from"./index-BekGhLC_.js";const F=()=>T.get("/api/category/list/TAG");function q(c){return c?c.replace(/(\*\*|__)(.*?)(\*\*|__)/g,"").replace(/\!\[[\s\S]*?\]\([\s\S]*?\)/g,"").replace(/\([\s\S]*?\)/g,"").replace(/<\/?.+?\/?>/g,"").replace(/(\*)(.*?)(\*)/g,"").replace(/`{1,2}[^`](.*?)`{1,2}/g,"").replace(/```([\s\S]*?)```[\s]*/g,"").replace(/\~\~(.*?)\~\~/g,"").replace(/[\s]*[-\*\+]+(.*)/g,"").replace(/[\s]*[0-9]+\.(.*)/g,"").replace(/(#+)(.*)/g,"").replace(/(>+)(.*)/g,"").replace(/\r\n/g,"").replace(/\n/g,"").replace(/\s/g,"").slice(0,180):""}const z={class:"lg:hidden"},P={__name:"MDEditor",setup(c){const v=D(),d=a(null),r=a(""),p=a(""),m=a(!1),_=a([]),s=a([]);h(()=>{m.value=!0,F().then(n=>{_.value=n.data.data,m.value=!1})});const y=()=>{if(!d.value.text)return i.error("No Markdown content");if(!r.value)return i.error("No title");if(!s.value.length)return i.error("No tag");d.value.save()},b=async(n,e)=>{console.log(n,e),await N({title:r.value,value:e,tags:s.value.join(","),category_id:1,thumbnail:"",extra:q(n)}),i.success("Create success"),v.replace("/admin/post-list")};return(n,e)=>{const k=o("a-button"),w=o("TitleLine"),M=o("a-input"),C=o("a-option"),L=o("a-select"),f=o("v-md-editor");return g(),V("div",null,[l(w,{title:"Markdown Editor"},{right:u(()=>[l(k,{type:"primary",onClick:y},{default:u(()=>e[3]||(e[3]=[S("Save / Create")])),_:1})]),_:1}),l(M,{size:"mini",type:"text",modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=t=>r.value=t),placeholder:"Title",class:"w-full p-2 mb-4"},null,8,["modelValue"]),l(L,{class:"mb-4",loading:m.value,multiple:"",modelValue:s.value,"onUpdate:modelValue":e[1]||(e[1]=t=>s.value=t),placeholder:"Select a tag"},{default:u(()=>[(g(!0),V(B,null,E(_.value,t=>(g(),U(C,{key:t.id,value:t.id},{default:u(()=>[S(j(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["loading","modelValue"]),l(f,{ref_key:"mdEditor",ref:d,modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=t=>p.value=t),height:"800px",onSave:b},null,8,["modelValue"]),x("div",z,[e[4]||(e[4]=x("h1",{class:"text-2xl font-bold mb-4 mt-4"},"Preview",-1)),l(f,{"model-value":p.value,mode:"preview"},null,8,["model-value"])])])}}};export{P as default};
